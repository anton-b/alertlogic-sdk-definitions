language: python
python:
  - 3.8
  - 3.7
install: pip install -U tox-travis
script: tox
env:
  matrix:
    - GITHUB_REPO=anton-b/alertlogic-sdk-definitions
  global:
    secure: am/vhuvw2njdCn0bBP4F7iHJKgb4wQzdeNnAdHG/FnHtdpV8AEro7UvnWYoJ+cf4uBIAqGxB4dnFZ4zay3o2bpp6oO7zbAAAReaWI6dDwb4Uv+52HWN86566JEgzH+/QR0f1ou/zO4URc2bBhmakTq2UTf+jwABFDHQxYibKcXciQbuqE3B6lr4Fpqwq+WQ0igZ7qFNOQEzQ8SnDCGgDKda9A35xn5ZTapLXdRuM0xG7XOtGAMzIidXdyBdzrdz4tarxGimJdIS+WvUMwRARce8b9adKgKSLm20TOYjh9NPdY9EmE/9gBI1ISte8OnSiFdWyP8Njux3osxaZQeSADUzyCHKfaHZqQKdfro/+AL6TbVGfqi0si7lhTWv09STsIxaOi9o2QVdm7ZFzt5r4z7+akiF5NSA/pIztmQ6XPnzFfNSA8WEpjH/crumL1NWoTmTQRUpEI1+f6BVP567r5KuhvNqtnYf0Babv5WdToIxJ3xXGQEgCk1o5F2U/tpyhjTGDsrHNE4nPAVCn3Jk4KZlBOS+tdG5Exsuu69UqHPPaNxlGnXJcKOxGjS7a0SZ0Vc050c8neBcQcDNnVuM7C2FL9+kTWj3Tgwfa+YKsZDkwq/SzBXwBkQMe3GV10AwQ2tZSeMS4cN2mga5+zIXlV/+nm042WTlwMwL64NzOscY=
jobs:
  include:
    - stage: merge-automated-prs
      python: 3.8
      script: BRANCHES_TO_MERGE_REGEX='^auto-update-' BRANCH_TO_MERGE_INTO=master scripts/travis-automerge.sh
    - stage: deploy
      deploy:
        provider: pypi
        distributions: sdist bdist_wheel
        cleanup: false
        user: __token__
        password:
          secure: eJMWcJY8inSzxPccLTlEN5nWzeDa2zzovgYX7HB+oeoNGEMSu+XS6HV1ILARHyDJovhPlkgZplFcJxjRZITBsjFAatpFeBSTqeV1/qkXs4rSY4wYF71x7dkBRQxEuAjsH9v1qzHvE9JXdzdvy/z/U36Dh1HXLhW9uYQ+Rfo0k/+VR6sAByMHAEFWCibt3UbrMm3l1j8X/95Z0h5+xJODnTc4QCiNK/HYhdzq5MU415CLHo1BLFlP6GyWK+Mi+bQu2cZnU+qnKlSYjmfKJYtL3tJ97TtXNRgvhiS2pgi+qldfNv8kaj9trkUJgsn6QaTGl93CEMthMCcVyYPd7qDjpN2If5NrWBqiTVid/g2HO33WleFRQjp9UF6eRsDozecSSVGefVZc6Aorl8usL9Kf0nKFHGm9P2lbjHofiJ23la8W43CT1gOSxUFs4u8v9AFh4aCI1v6TwdlVX7/1EbcsFsOFVXBEuE6RB0ZGbSQcafcObdxbg8wNJsDBpz/JVFicWdfTZ1C4LEZkAsuwwHvLlfwYX51984fr5493h7CNmWfHziMXTp68YvZsoQ8OCVDEAerYMf6eeWBXhZWDJLUUBPl89u7pVnQrKq9YyZCsUJSfrq6pQ4+3bsiLgwp4Zyho4XS8w8Y1bXbjX/6jFAK5tXMexKkg19jLd/V0ef6eEsY=
        on:
          tags: true
          repo: "$GITHUB_REPO"
          python: 3.8